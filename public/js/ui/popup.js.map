{"version":3,"sources":["ui/popup.ts"],"names":[],"mappings":";AAAA;IAII,eAAqB,OAAc,EAAU,IAAoB,EAAU,MAAe;QAArD,oBAA4B,GAA5B,YAA4B;QAAE,sBAAuB,GAAvB,WAAuB;QAArE,YAAO,GAAP,OAAO,CAAO;QAAU,SAAI,GAAJ,IAAI,CAAgB;QAAU,WAAM,GAAN,MAAM,CAAS;IAAgB,CAAC;IAEpG,oBAAI,GAAX;QAAA,iBAQC;QAPG,IAAI,OAAO,GAAS,MAAO,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,EAAE;YAC5C,WAAW,EAAE,aAAa;SAC7B,CAAC;aACG,IAAI,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,IAAI,EAAE,EAAf,CAAe,CAAC;aACjC,IAAI,CAAC,UAAA,QAAQ,IAAI,OAAA,KAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,EAA9B,CAA8B,CAAC,CAAC;QAEtD,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IAEO,+BAAe,GAAvB,UAAwB,QAAe;QACnC,IAAI,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC1C,IAAI,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC5C,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAC7B,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QACjC,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;QAE3B,OAAO,CAAC,SAAS,GAAG,QAAQ,CAAC;QAE7B,IAAI,KAAK,GAAG,OAAO,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;QAC7C,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YACpC,KAAK,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;QAC7D,CAAC;QAED,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QACjC,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;IACzB,CAAC;IAEO,8BAAc,GAAtB,UAAuB,CAAC;QACpB,CAAC,CAAC,cAAc,EAAE,CAAC;QAEnB,IAAI,QAAQ,GAAO,IAAI,QAAQ,CAAO,IAAK,CAAC,CAAC;QAC7C,IAAI,KAAK,GAAG,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAE7B,MAAO,CAAC,KAAK,CAAO,IAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,EAAE;YACpD,MAAM,EAAQ,IAAK,CAAC,YAAY,CAAC,QAAQ,CAAC;YAC1C,IAAI,EAAE,QAAQ;YACd,WAAW,EAAE,aAAa;YAC1B,OAAO,EAAE;gBACL,QAAQ,EAAE,QAAQ,CAAC,MAAM;aAC5B;SACJ,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;IACjC,CAAC;IAEO,8BAAc,GAAtB;QACI,EAAE,CAAC,CAAC,OAAO,IAAI,CAAC,MAAM,CAAC,yBAAyB,CAAC,KAAK,WAAW,IAAI,IAAI,CAAC,MAAM,CAAC,yBAAyB,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC;YAClH,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACzD,CAAC;IACL,CAAC;IAEL,YAAC;AAAD,CAxDA,AAwDC,IAAA;AAxDY,aAAK,QAwDjB,CAAA","file":"ui/popup.js","sourcesContent":["export class Popup {\r\n\r\n    protected element:any;\r\n\r\n    constructor (private content:string, private ajax:boolean = false, private config:any = {}) { /* empty */ }\r\n\r\n    public show():Popup {\r\n        var request = (<any>window).fetch(this.content, {\r\n            credentials: 'same-origin'\r\n        })\r\n            .then(response => response.text())\r\n            .then(response => this.onContentLoaded(response));\r\n\r\n        return this;\r\n    }\r\n\r\n    private onContentLoaded(response:string):void {\r\n        var popup = document.createElement('div');\r\n        var content = document.createElement('div');\r\n        popup.classList.add('popup');\r\n        content.classList.add('content');\r\n        popup.appendChild(content);\r\n\r\n        content.innerHTML = response;\r\n\r\n        var forms = content.querySelectorAll('form');\r\n        for (var i = 0; i < forms.length; i++) {\r\n            forms[i].addEventListener('submit', this.onFormSubmited);\r\n        }\r\n\r\n        document.body.appendChild(popup);\r\n        this.element = popup;\r\n    }\r\n\r\n    private onFormSubmited(e):void {\r\n        e.preventDefault();\r\n\r\n        var formData:any = new FormData((<any>this));\r\n        var token = formData.get('_token');\r\n\r\n        (<any>window).fetch((<any>this).getAttribute('action'), {\r\n            method: (<any>this).getAttribute('method'),\r\n            body: formData,\r\n            credentials: 'same-origin',\r\n            headers: {\r\n                'Cookie': document.cookie\r\n            }\r\n        }).then(this.onFormResponse);\r\n    }\r\n\r\n    private onFormResponse():void {\r\n        if (typeof this.config['close_after_form_submit'] !== \"undefined\" && this.config['close_after_form_submit'] == true) {\r\n            this.element.parentElement.removeChild(this.element);\r\n        }\r\n    }\r\n\r\n}"],"sourceRoot":"/source/"}