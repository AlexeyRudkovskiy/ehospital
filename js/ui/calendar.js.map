{"version":3,"sources":["ui/calendar.ts"],"names":[],"mappings":"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","file":"calendar.js","sourcesContent":["export class CalendarWrapper {\n\n    private globalConfig:any = {};\n\n    element:HTMLElement;\n\n    currentMonthLabel:HTMLElement = null;\n\n    calendarDatesTable:HTMLElement = null;\n\n    datesContainer:any;\n\n    currentMonth:number;\n\n    currentYear:number;\n\n    prevMonthLastDayInWeek:number;\n\n    daysInCurrentMonth:number;\n\n    daysInPrevMonth:number;\n\n    onDayClicked:any = null;\n\n    registeredCells:HTMLElement[] = [];\n\n    private labels:string[] = [\n        \"Январь\",\n        \"Февраль\",\n        \"Март\",\n        \"Апрель\",\n        \"Май\",\n        \"Июнь\",\n        \"Июль\",\n        \"Август\",\n        \"Сентябрь\",\n        \"Октябрь\",\n        \"Ноябрь\",\n        \"Декабрь\"\n    ];\n\n    constructor() {\n        this.datesContainer = {};\n    }\n\n    setMonth (year:number, month:number) {\n        if (month > 11) {\n            month = 0;\n            year++;\n        }\n\n        if (month < 0) {\n            month = 11;\n            year--;\n        }\n\n        let prevMonth = new Date(year, month, 0);\n\n        this.currentYear = year;\n        this.currentMonth = month;\n\n        this.daysInCurrentMonth = (new Date(year, month + 1, 0)).getDate();\n        this.daysInPrevMonth = (prevMonth).getDate();\n\n        this.prevMonthLastDayInWeek = (prevMonth).getDay();\n        if (this.prevMonthLastDayInWeek == 0) {\n            this.prevMonthLastDayInWeek = 7;\n        }\n\n        this.prevMonthLastDayInWeek--;\n\n        if (this.currentMonthLabel !== null) {\n            this.currentMonthLabel.innerHTML = this.labels[month];\n        }\n\n        this.redrawTable();\n    }\n\n    redrawTable () {\n        while (this.calendarDatesTable.firstElementChild) {\n            this.calendarDatesTable.removeChild(this.calendarDatesTable.firstElementChild);\n        }\n\n        let tr = document.createElement('tr');\n        let totalDays:number = this.prevMonthLastDayInWeek + 1;\n        let nextMonthDays:number = 1;\n\n        this.registeredCells.splice(0, this.registeredCells.length);\n\n        for (let i = 0; i <= this.prevMonthLastDayInWeek; i++) {\n            let td = document.createElement('td');\n            let dayWrapper = document.createElement('span');\n\n            dayWrapper.classList.add('day-wrapper');\n            td.classList.add('disabled');\n\n            dayWrapper.innerHTML = (this.daysInPrevMonth - (this.prevMonthLastDayInWeek - i)).toString();\n\n            tr.appendChild(td);\n            td.appendChild(dayWrapper);\n        }\n\n        for (let i = 1; i <= this.daysInCurrentMonth; i++) {\n            let td = document.createElement('td');\n            let dayWrapper = document.createElement('span');\n\n            dayWrapper.classList.add('day-wrapper');\n\n            dayWrapper.innerHTML = i.toString();\n\n            tr.appendChild(td);\n            td.appendChild(dayWrapper);\n\n            let dayTag:string = [i, (this.currentMonth + 1), this.currentYear].join('.');\n            td.setAttribute('data-tag', dayTag);\n\n            td.addEventListener('click', this.onDayClickedCallback.bind({\n                element: td,\n                calendar: this\n            }));\n\n            if (typeof this.datesContainer[dayTag] !== \"undefined\" && (\n                this.datesContainer[dayTag].nomenclatures.length > 0 ||\n                this.datesContainer[dayTag].procedures.length > 0\n            )) {\n                td.classList.add('active');\n            }\n\n            totalDays++;\n\n            if (totalDays % 7 === 0) {\n                this.calendarDatesTable.appendChild(tr);\n                tr = document.createElement('tr');\n            }\n\n            this.registeredCells.push(td);\n        }\n\n        while (totalDays % 7 !== 0) {\n            let td = document.createElement('td');\n            let dayWrapper = document.createElement('span');\n\n            dayWrapper.classList.add('day-wrapper');\n            td.classList.add('disabled');\n\n            dayWrapper.innerHTML = nextMonthDays.toString();\n\n            tr.appendChild(td);\n            td.appendChild(dayWrapper);\n\n            totalDays++;\n            nextMonthDays++;\n        }\n\n        this.calendarDatesTable.appendChild(tr);\n    }\n\n    replaceDayDate (day:string, value:any) {\n        if (typeof this.datesContainer[day] === \"undefined\") {\n            this.datesContainer[day] = {};\n        }\n\n        this.datesContainer[day] = value;\n    }\n\n    removeDayDate (day:string) {\n        if (typeof this.datesContainer[day] !== \"undefined\") {\n            delete this.datesContainer[day];\n        }\n    }\n\n    getDayDate (day:string) {\n        if (typeof this.datesContainer[day] === \"undefined\") {\n            this.datesContainer[day] = {};\n        }\n\n        return this.datesContainer[day];\n    }\n\n    private onDayClickedCallback () {\n        if ((this as any).calendar.onDayClicked !== null) {\n            (this as any).calendar.onDayClicked.apply(window, [\n                (this as any).element.getAttribute('data-tag'),\n                (this as any).calendar.getDayDate((this as any).element.getAttribute('data-tag')),\n                (this as any).calendar\n            ]);\n        }\n\n        for (let i = 0; i < (this as any).calendar.registeredCells.length; i++) {\n            if ((this as any).calendar.registeredCells[i].classList.contains('highlight')) {\n                (this as any).calendar.registeredCells[i].classList.remove('highlight');\n            }\n        }\n\n\n        this.element.classList.add('highlight');\n    }\n\n}\n\nconst calendars:CalendarWrapper[] = [];\n\nfunction onPrevMonthButtonClicked () {\n    this.calendar.setMonth(this.calendar.currentYear, this.calendar.currentMonth - 1);\n}\n\nfunction onNextMonthButtonClicked () {\n    this.calendar.setMonth(this.calendar.currentYear, this.calendar.currentMonth + 1);\n}\n\nexport function createCalendars (target:HTMLElement, predefined:any = {}) : CalendarWrapper {\n\n    const calendar:CalendarWrapper = new CalendarWrapper();\n\n    const prevMonthButton = target.querySelector('.prev-month');\n    const nextMonthButton = target.querySelector('.next-month');\n    \n    const currentDate:Date = new Date();\n\n    calendar.element = target;\n\n    calendar.currentMonthLabel = target.querySelector('.current-month') as HTMLElement;\n\n    calendar.calendarDatesTable = target.querySelector('.calendar-content > table > tbody') as HTMLElement;\n\n    calendars.push(calendar);\n\n    calendar.datesContainer = predefined;\n\n    calendar.setMonth(currentDate.getFullYear(), currentDate.getMonth());\n    \n    prevMonthButton.addEventListener('click', onPrevMonthButtonClicked.bind({\n        calendar: calendar\n    }));\n    \n    nextMonthButton.addEventListener('click', onNextMonthButtonClicked.bind({\n        calendar: calendar\n    }));\n\n    return calendar;\n\n}"]}