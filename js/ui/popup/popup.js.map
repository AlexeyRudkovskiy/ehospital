{"version":3,"sources":["ui/popup/popup.ts"],"names":[],"mappings":"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","file":"popup.js","sourcesContent":["///<reference path=\"../../fixes.d.ts\" />\n\nimport 'whatwg-fetch';\nimport {ContentBuilder} from \"./content-builder\";\nimport JSONContentBuilder from \"./json-content-builder\";\nimport HTMLContentBuilder from \"./html-content-builder\";\nimport lang from \"../../lang\"\n\nimport spinner from '/resources/spinner.svg!text';\n\nenum CONTENT_TYPES {\n    JSON, TEXT\n}\n\nexport default class Popup {\n\n    private static openedPopupCount:number = 0;\n\n    private currentPopupId:number;\n\n    private wrapper:HTMLDivElement;\n\n    private popup:HTMLDivElement;\n\n    private header:HTMLDivElement = null;\n\n    private _footer:HTMLDivElement = null;\n\n    private content:HTMLDivElement = null;\n\n    private loadedContentType:CONTENT_TYPES = null;\n\n    private minTopLocation:number = 50;\n\n    private _isForm:boolean = false;\n\n    private _jsonContentBuilder:ContentBuilder = null;\n\n    private _basicContentBuilder:ContentBuilder = null;\n\n    private _customClasses:string[] = [];\n\n    private _onPopupAppeared:any = null;\n\n    public onSubmit:any = null;\n\n    static ESC_KEY_CODE:number = 27;\n\n    constructor(private url:string = null, private title:string = null, private subtitle:string = null) {\n        Popup.openedPopupCount++;\n        this.currentPopupId = Popup.openedPopupCount;\n    }\n\n    public show () {\n        document.body.appendChild(this.wrapper);\n\n        let functionContainer:any = {\n            instance: this\n        };\n        let callback = this.onKeyUpEventListener.bind(functionContainer);\n        functionContainer.callback = callback;\n        window.addEventListener('keyup', callback, true);\n\n        this.setPopupLocation();\n\n        if (this._onPopupAppeared !== null) {\n            this._onPopupAppeared.call(window, this);\n        }\n    }\n\n    public close() {\n        Popup.openedPopupCount--;\n        document.body.removeChild(this.wrapper);\n    }\n\n    public create(data:any = null, noContentPaddings:boolean = false) {\n        this.wrapper = document.createElement('div');\n        this.wrapper.classList.add('popup-wrapper');\n        this.wrapper.style.zIndex = this.popupId.toString();\n\n        if (this.url !== null) {\n            this.createLoader();\n            this.showLoader();\n        } else {\n            let body = document.createElement('div');\n            body.classList.add('popup');\n\n            this.popup = body;\n            this.wrapper.appendChild(this.popup);\n            this.popup.classList.remove('popup-loader');\n            this.content = this._basicContentBuilder.build(data);\n\n            this.content.classList.add('popup-content');\n            if (noContentPaddings) {\n                this.popup.classList.add('popup-no-content-paddings');\n            }\n\n            this.popup.innerHTML = \"\";\n\n            for (let i = 0; i < this._customClasses.length; i++) {\n                this.popup.classList.add(this._customClasses[i]);\n            }\n\n            if (this.header === null) {\n                this.header = this.createHeader();\n            }\n\n            this.popup.appendChild(this.header);\n\n            if (this.content !== null) {\n                this.popup.appendChild(this.content);\n            }\n            if (this._footer === null) {\n                if (this._isForm) {\n                    this._footer = this.createFormFooter();\n                }\n            }\n\n            if (typeof this._footer !== \"undefined\" && this._footer !== null) {\n                this.popup.appendChild(this._footer);\n            }\n\n            this.setPopupLocation();\n        }\n    }\n\n    public get popupId():number {\n        return 100 + this.currentPopupId;\n    }\n\n    public setPopupLocation() {\n        const screenHeight: number = window.innerHeight;\n        const popupHeight = this.popup.offsetHeight;\n\n        if (popupHeight > screenHeight - this.minTopLocation) {\n            this.popup.style.marginTop = this.minTopLocation + \"px\";\n        } else {\n            this.popup.style.marginTop = (screenHeight / 2 - popupHeight / 2) + \"px\";\n        }\n    }\n\n    private createLoader() {\n        const loader = document.createElement('div');\n        loader.classList.add('popup', 'popup-loader');\n        loader.innerHTML = spinner;\n\n        this.popup = loader;\n    }\n\n    private showLoader() {\n        this.wrapper.appendChild(this.popup);\n\n        (window as any).fetch(this.url)\n            .then(this.getContent.bind(this))\n            .then(this.buildContent.bind(this))\n            .then((builderStructure:any) => builderStructure.builder.build(builderStructure.data))\n            .then(element => this.replaceLoaderWith(element))\n            .catch(console.error.bind(console));\n    }\n\n    private replaceLoaderWith(element:HTMLElement) {\n        this.popup.classList.remove('popup-loader');\n        this.content = document.createElement('div');\n\n        this.content.classList.add('popup-content');\n        this.content.appendChild(element as HTMLDivElement);\n\n        this.popup.innerHTML = \"\";\n\n        if (this.header === null) {\n            this.header = this.createHeader();\n        }\n\n        this.popup.appendChild(this.header);\n\n        if (this.content !== null) {\n            this.popup.appendChild(this.content);\n        }\n        if (this._footer === null) {\n            if (this._isForm) {\n                this._footer = this.createFormFooter();\n            }\n        }\n\n        if (typeof this._footer !== \"undefined\" && this._footer !== null) {\n            this.popup.appendChild(this._footer);\n        }\n\n        this.setPopupLocation();\n    }\n\n    private getContent (response:any) : any {\n        const contentType:string = response.headers.get('content-type');\n        let type:string = null;\n        if (contentType.indexOf('application/json') !== -1) {\n            this.loadedContentType = CONTENT_TYPES.JSON;\n            return response.json();\n        } else {\n            this.loadedContentType = CONTENT_TYPES.TEXT;\n            return response.text();\n        }\n    }\n\n    private buildContent (data:any) : any {\n        let builder:ContentBuilder = null;\n        switch (this.loadedContentType) {\n            case CONTENT_TYPES.JSON:\n                if (this._jsonContentBuilder === null) {\n                    throw \"Popup::buildContent JSONContentBuilder is empty\";\n                }\n                builder = this._jsonContentBuilder;\n                break;\n            case CONTENT_TYPES.TEXT:\n                builder = new HTMLContentBuilder();\n                break;\n        }\n        return {\n            builder: builder,\n            data: data\n        }\n    }\n\n    private createHeader() : HTMLDivElement {\n        const container:HTMLDivElement = document.createElement('div');\n        const popupTitle:HTMLDivElement = document.createElement('div');\n        const popupClose:HTMLDivElement = document.createElement('div');\n        const close:HTMLElement = document.createElement('i');\n\n        container.classList.add('popup-header', 'popup-header-large-bottom-offset');\n        popupTitle.classList.add('popup-title');\n        popupClose.classList.add('popup-close');\n        close.classList.add('material-icons');\n\n        close.innerHTML = 'close';\n\n        container.appendChild(popupTitle);\n        container.appendChild(popupClose);\n\n        popupClose.appendChild(close);\n\n        if (this.title !== null && this.title.length > 0) {\n            const title:HTMLParagraphElement = document.createElement('p');\n\n            title.classList.add('title');\n            title.innerHTML = this.title;\n\n            popupTitle.appendChild(title);\n        }\n\n        if (this.subtitle !== null && this.subtitle.length > 0) {\n            const subtitle:HTMLParagraphElement = document.createElement('p');\n\n            subtitle.classList.add('subtitle');\n            subtitle.innerHTML = this.subtitle;\n\n            popupTitle.appendChild(subtitle);\n        }\n\n        close.addEventListener('click', this.closePopup.bind(this));\n\n        return container;\n    }\n\n    private createFormFooter() : HTMLDivElement {\n        const container:HTMLDivElement = document.createElement('div');\n        const pullRight:HTMLDivElement = document.createElement('div');\n        const send:HTMLElement = document.createElement('a');\n\n        container.classList.add('popup-footer');\n        pullRight.classList.add('pull-right');\n        send.classList.add('ghost-btn', 'ghost-btn-primary');\n\n        send.innerHTML = lang.get('ui.form.send');\n        send.setAttribute('href', 'javascript:');\n\n        container.appendChild(pullRight);\n        pullRight.appendChild(send);\n\n        send.addEventListener('click', this.sendPopupForm.bind(this));\n\n        return container;\n    }\n\n    private closePopup (e:Event) {\n        e.preventDefault();\n\n        this.close();\n    }\n\n    private sendPopupForm (e:Event) {\n        e.preventDefault();\n\n        if (this.onSubmit === null) {\n            (this.content.querySelector('form') as HTMLFormElement).submit();\n        } else {\n            this.onSubmit.call(window, this.content.querySelector('form'));\n        }\n    }\n\n    setOnSubmitEventListener (callback:any) {\n        this.onSubmit = callback;\n    }\n\n    private onKeyUpEventListener (e:KeyboardEvent) {\n        if (e.keyCode === Popup.ESC_KEY_CODE) {\n            window.removeEventListener('keyup', (this as any).callback, true);\n            (this as any).instance.close();\n        }\n    }\n\n    set jsonContentBuilder(value: ContentBuilder) {\n        this._jsonContentBuilder = value;\n    }\n\n    set basicContentBuilder (value: ContentBuilder) {\n        this._basicContentBuilder = value;\n    }\n\n    set isForm(value: boolean) {\n        this._isForm = value;\n    }\n\n    set customClasses(value: string[]) {\n        this._customClasses = value;\n    }\n\n    set footer(value: HTMLDivElement) {\n        this._footer = value;\n    }\n\n    set onPopupAppeared(value: any) {\n        this._onPopupAppeared = value;\n    }\n\n}"]}